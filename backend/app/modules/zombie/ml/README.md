# ğŸ§Ÿâ€â™‚ï¸ ResNet18ãƒ™ãƒ¼ã‚¹ ã‚¾ãƒ³ãƒ“åˆ†é¡å™¨

YOLOv8ã§æ¤œå‡ºã—ãŸäººç‰©é ˜åŸŸãŒã€Œã‚¾ãƒ³ãƒ“ã‹ã©ã†ã‹ã€ã‚’åˆ¤å®šã™ã‚‹è»½é‡ãªç”»åƒåˆ†é¡ãƒ¢ãƒ‡ãƒ«

## ğŸ“ æ¦‚è¦

- **ç›®çš„**: YOLOã§åˆ‡ã‚Šå‡ºã•ã‚ŒãŸäººç‰©é ˜åŸŸç”»åƒã«å¯¾ã—ã¦ã€Œã‚¾ãƒ³ãƒ“ã£ã½ã•ã€ã‚’åˆ¤å®š
- **ãƒ¢ãƒ‡ãƒ«**: ResNet18ãƒ™ãƒ¼ã‚¹ã®è»¢ç§»å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ï¼ˆè»½é‡ãƒ»é«˜é€Ÿï¼‰
- **å…¥åŠ›**: 224x224 RGBç”»åƒ
- **å‡ºåŠ›**: 2ã‚¯ãƒ©ã‚¹åˆ†é¡ï¼ˆ`zombie`, `not_zombie`ï¼‰
- **ç‰¹å¾´**: 
  - å…¨çµåˆå±¤ã®ã¿ã®å­¦ç¿’ or å…¨å±¤å¾®èª¿æ•´ã®é¸æŠãŒå¯èƒ½
  - æ¨è«–æ™‚ã®NumPyé…åˆ—ï¼ˆYOLOã®åˆ‡ã‚Šå‡ºã—é ˜åŸŸï¼‰å…¥åŠ›ã«å¯¾å¿œ

## ğŸ—‚ï¸ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæ§‹é€ 

```
data/datasets/zombie_classifier/
â”œâ”€â”€ zombie/       # ã‚¾ãƒ³ãƒ“ã®ç”»åƒï¼ˆ.pngå½¢å¼ï¼‰
â””â”€â”€ not_zombie/   # ã‚¾ãƒ³ãƒ“ã§ã¯ãªã„ç”»åƒï¼ˆ.pngå½¢å¼ï¼‰
```

## ğŸ”§ å­¦ç¿’æ–¹æ³•

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å­¦ç¿’ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼š

```bash
python backend/app/modules/zombie/ml/train_zombie_classifier.py --epochs 30 --batch_size 32
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ |
|------------|------|------------|
| `--data_path` | ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ‘ã‚¹ | `data/datasets/zombie_classifier` |
| `--batch_size` | ãƒãƒƒãƒã‚µã‚¤ã‚º | `32` |
| `--epochs` | å­¦ç¿’ã‚¨ãƒãƒƒã‚¯æ•° | `30` |
| `--lr` | å­¦ç¿’ç‡ | `1e-4` |
| `--finetune` | å…¨å±¤å¾®èª¿æ•´ãƒ¢ãƒ¼ãƒ‰ï¼ˆæŒ‡å®šã—ãªã„å ´åˆã¯å…¨çµåˆå±¤ã®ã¿å­¦ç¿’ï¼‰ | `False` |

### å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

- **ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/models/zombie_classifier.pt`
- **æ··åŒè¡Œåˆ—**: `backend/app/modules/zombie/ml/confusion_matrix.png`
- **å­¦ç¿’å±¥æ­´**: `backend/app/modules/zombie/ml/training_history.png`
- **åˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ**: ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å‡ºåŠ›ï¼ˆç²¾åº¦ãƒ»å†ç¾ç‡ãƒ»F1ã‚¹ã‚³ã‚¢ï¼‰

## ğŸ”® æ¨è«–æ–¹æ³•

æ¨è«–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã£ã¦ã€å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã§ã‚¾ãƒ³ãƒ“åˆ†é¡ã‚’è¡Œãˆã¾ã™ï¼š

```bash
python backend/app/modules/zombie/ml/infer_zombie_classifier.py [ç”»åƒãƒ‘ã‚¹]
```

ç”»åƒãƒ‘ã‚¹ã‚’æŒ‡å®šã—ãªã„å ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«ç”»åƒã‚’é¸æŠã—ã¦æ¨è«–ã—ã¾ã™ã€‚

### APIã§ã®åˆ©ç”¨ä¾‹

```python
from backend.app.modules.zombie.ml.infer_zombie_classifier import ZombieClassifier

# åˆ†é¡å™¨ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
classifier = ZombieClassifier()

# ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®äºˆæ¸¬
pred_class, prob = classifier.predict_image("path/to/image.png")

# ãƒã‚¤ãƒˆãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã®äºˆæ¸¬
with open("path/to/image.png", "rb") as f:
    img_bytes = f.read()
pred_class, prob = classifier.predict_bytes(img_bytes)

# NumPyé…åˆ—ã‹ã‚‰ã®äºˆæ¸¬ï¼ˆYOLOã®åˆ‡ã‚Šå‡ºã—é ˜åŸŸï¼‰
# img_array ã¯ (H, W, 3) ã®å½¢çŠ¶ã€RGBå½¢å¼
pred_class, prob = classifier.predict_numpy(img_array)
```

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

ãƒ¢ãƒ‡ãƒ«ã®å¤§ãã•ã¨æ¨è«–é€Ÿåº¦ã®æ¯”è¼ƒï¼š

| ãƒ¢ãƒ‡ãƒ« | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•° | ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º | æ¨è«–é€Ÿåº¦ |
|--------|------------|------------|----------|
| ResNet18 | ç´„11M | ç´„44MB | é«˜é€Ÿ |
| ResNet34 | ç´„21M | ç´„84MB | ä¸­é€Ÿ |

â€» ResNet18ã¯ã€ResNet34ã«æ¯”ã¹ã¦ç´„åŠåˆ†ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ã§ã€æ¨è«–é€Ÿåº¦ã‚‚å‘ä¸Š

## ğŸ“š ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- PyTorch
- torchvision
- NumPy
- Pillow
- scikit-learn
- matplotlib
- seaborn 